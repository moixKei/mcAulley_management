<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Detalle de Alumna - McAulley</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <!-- Header -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h1>👤 Detalle de Alumna</h1>
                <p class="text-muted">Información completa de la alumna</p>
            </div>
            <div>
                <a th:href="@{/alumnas}" class="btn btn-outline-secondary me-2">
                    <i class="fas fa-arrow-left"></i> Volver
                </a>
                <a th:href="@{/alumnas/editar/} + ${alumna.idAlumna}" class="btn btn-warning">
                    <i class="fas fa-edit"></i> Editar
                </a>
            </div>
        </div>

        <!-- Mensajes -->
        <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert">
            <span th:text="${success}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <span th:text="${error}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

        <!-- Tarjeta de Información Principal -->
        <div class="row">
            <div class="col-lg-8">
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-id-card"></i> Información Personal
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <table class="table table-borderless">
                                    <tr>
                                        <th width="40%">ID:</th>
                                        <td>
                                            <span class="badge bg-secondary" th:text="${alumna.idAlumna}"></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>Nombre Completo:</th>
                                        <td>
                                            <h5 th:text="${alumna.nombre + ' ' + alumna.apellido}"></h5>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th>DNI:</th>
                                        <td>
                                            <code class="fs-5" th:text="${alumna.dni}"></code>
                                        </td>
                                    </tr>
                                    <tr>
                                        <!-- En detalle.html, actualiza esta parte -->
<p><strong>Estado:</strong> 
    <span th:if="${curso.estado != null}" 
          th:text="${curso.estado.nombre}"
          th:classappend="${curso.estado.nombre == 'Activo'} ? 'badge bg-success' : 
                          ${curso.estado.nombre == 'Inactivo'} ? 'badge bg-danger' : 
                          'badge bg-warning'">
    </span>
    <span th:if="${curso.estado == null}" class="badge bg-secondary">
        No asignado
    </span>
</p>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-md-6">
                                <table class="table table-borderless">
                                    <tr>
                                        <th width="40%">Fecha Registro:</th>
                                        <td th:text="${#temporals.format(alumna.fechaRegistro, 'dd/MM/yyyy')}"></td>
                                    </tr>
                                    <tr th:if="${alumna.fechaActualizacion}">
                                        <th>Última Actualización:</th>
                                        <td th:text="${#temporals.format(alumna.fechaActualizacion, 'dd/MM/yyyy HH:mm')}"></td>
                                    </tr>
                                    <tr th:if="${alumna.correo}">
                                        <th>Correo:</th>
                                        <td>
                                            <i class="fas fa-envelope text-muted me-2"></i>
                                            <a th:href="'mailto:' + ${alumna.correo}" th:text="${alumna.correo}"></a>
                                        </td>
                                    </tr>
                                    <tr th:if="${alumna.celular}">
                                        <th>Celular:</th>
                                        <td>
                                            <i class="fas fa-phone text-muted me-2"></i>
                                            <span th:text="${alumna.celular}"></span>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Información de Contacto -->
                <div class="card mb-4" th:if="${alumna.direccion}">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">
                            <i class="fas fa-map-marker-alt"></i> Información de Contacto
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-12">
                                <strong>Dirección:</strong>
                                <p class="mb-0 mt-1" th:text="${alumna.direccion}"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Panel Lateral - Acciones Rápidas -->
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-bolt"></i> Acciones Rápidas
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <!-- Toggle Estado -->
                            <form th:action="@{/alumnas/toggle-estado/} + ${alumna.idAlumna}" method="post" class="d-grid">
                                <button type="submit" 
                                        th:classappend="${alumna.activo} ? 'btn-warning' : 'btn-success'"
                                        class="btn btn-lg">
                                    <i th:classappend="${alumna.activo} ? 'fa-toggle-off' : 'fa-toggle-on'" 
                                       class="fas me-2"></i>
                                    <span th:text="${alumna.activo} ? 'Desactivar Alumna' : 'Activar Alumna'"></span>
                                </button>
                            </form>

                            <!-- Editar -->
                            <a th:href="@{/alumnas/editar/} + ${alumna.idAlumna}" 
                               class="btn btn-outline-primary btn-lg">
                                <i class="fas fa-edit me-2"></i> Editar Información
                            </a>

                            <!-- Eliminar con Modal -->
                            <button type="button" 
                                    class="btn btn-outline-danger btn-lg" 
                                    data-bs-toggle="modal" 
                                    data-bs-target="#modalEliminar">
                                <i class="fas fa-trash me-2"></i> Eliminar Alumna
                            </button>

                            <!-- Volver a lista -->
                            <a th:href="@{/alumnas}" class="btn btn-outline-secondary">
                                <i class="fas fa-list me-2"></i> Ver Todas las Alumnas
                            </a>
                        </div>

                        <!-- Información de Sistema -->
                        <div class="mt-4 pt-3 border-top">
                            <h6><i class="fas fa-info-circle"></i> Información del Sistema</h6>
                            <small class="text-muted">
                                <div>ID: <strong th:text="${alumna.idAlumna}"></strong></div>
                                <div>Registrada: <strong th:text="${#temporals.format(alumna.fechaRegistro, 'dd/MM/yyyy')}"></strong></div>
                                <div th:if="${alumna.fechaActualizacion}">
                                    Actualizada: <strong th:text="${#temporals.format(alumna.fechaActualizacion, 'dd/MM/yyyy HH:mm')}"></strong>
                                </div>
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Panel de Estadísticas (futuras integraciones) -->
        <div class="card">
            <div class="card-header bg-light">
                <h5 class="mb-0">
                    <i class="fas fa-chart-line"></i> Actividad Relacionada
                    <small class="text-muted">(Próximamente)</small>
                </h5>
            </div>
            <div class="card-body text-center py-5">
                <i class="fas fa-clock fa-3x text-muted mb-3"></i>
                <h5 class="text-muted">Información de actividad en desarrollo</h5>
                <p class="text-muted">
                    Próximamente podrás ver:
                    <br>• Cursos inscritos
                    <br>• Historial de pagos  
                    <br>• Asistencia a clases
                    <br>• Notas y progreso
                </p>
            </div>
        </div>
    </div>

    <!-- Modal de Confirmación para Eliminar -->
    <div class="modal fade" id="modalEliminar" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-danger">
                        <i class="fas fa-exclamation-triangle"></i> Confirmar Eliminación
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-danger">
                        <h6>¿Estás seguro de que deseas eliminar esta alumna?</h6>
                        <p class="mb-2">Esta acción <strong>NO se puede deshacer</strong> y se perderá toda la información asociada.</p>
                    </div>
                    <div class="card">
                        <div class="card-body">
                            <strong th:text="${alumna.nombre + ' ' + alumna.apellido}"></strong><br>
                            <small class="text-muted">DNI: <code th:text="${alumna.dni}"></code></small><br>
                            <small class="text-muted">ID: <code th:text="${alumna.idAlumna}"></code></small>
                        </div>
                    </div>
                    <div class="mt-3">
                        <small class="text-muted">
                            <i class="fas fa-info-circle"></i> 
                            La eliminación es permanente y afectará cualquier información relacionada con esta alumna.
                        </small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                    <form th:action="@{/alumnas/eliminar/} + ${alumna.idAlumna}" method="post">
                        <button type="submit" class="btn btn-danger">
                            <i class="fas fa-trash"></i> Sí, Eliminar
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Auto-dismiss alerts
        setTimeout(function() {
            const alerts = document.querySelectorAll('.alert');
            alerts.forEach(function(alert) {
                if (alert.classList.contains('alert-dismissible')) {
                    const bsAlert = new bootstrap.Alert(alert);
                    bsAlert.close();
                }
            });
        }, 5000);
    </script>
</body>
</html>